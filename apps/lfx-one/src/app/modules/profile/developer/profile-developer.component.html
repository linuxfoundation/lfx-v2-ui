<!-- Copyright The Linux Foundation and each contributor to LFX. -->
<!-- SPDX-License-Identifier: MIT -->

<div class="container mx-auto pb-8">
  <!-- Developer Settings Info Banner -->
  <lfx-message severity="info" icon="fa-light fa-code" styleClass="mb-6" title="Developer API Access">
    <ng-template #content>
      <div class="flex flex-col gap-1">
        <p class="text-sm">
          Your API token provides programmatic access to LFX services. Keep this token secure and never share it publicly.
        </p>
      </div>
    </ng-template>
  </lfx-message>

  <div class="flex flex-col gap-6">
    <!-- API Token Section -->
    <lfx-card>
      <div class="flex flex-col gap-6">
        <div>
          <h3 class="text-base font-medium text-gray-900" data-testid="developer-token-heading">API Token</h3>
          <p class="text-sm text-gray-500 mt-1">Your personal access token for API authentication</p>
        </div>

        @if (isLoading()) {
          <div class="flex items-center justify-center py-4" data-testid="developer-token-loading">
            <i class="fa-light fa-circle-notch fa-spin text-2xl text-blue-400"></i>
            <span class="ml-3 text-gray-600">Loading token...</span>
          </div>
        } @else {
          <div class="space-y-4">
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                  <tr>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Token</th>
                    <th scope="col" class="relative px-6 py-3">
                      <span class="sr-only">Actions</span>
                    </th>
                  </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                  <tr>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <div class="flex items-center">
                        <div class="flex-shrink-0">
                          <i class="fa-light fa-key text-gray-400"></i>
                        </div>
                        <div class="ml-3">
                          <div class="text-sm font-mono text-gray-900" data-testid="api-token-display">
                            {{ maskToken() ? maskedToken() : apiToken() }}
                          </div>
                          <div class="text-xs text-gray-500">Personal Access Token</div>
                        </div>
                      </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2">
                      <button
                        type="button"
                        (click)="toggleTokenVisibility()"
                        class="text-blue-600 hover:text-blue-800 transition-colors"
                        [attr.data-testid]="'token-visibility-toggle'"
                        [attr.aria-label]="maskToken() ? 'Show token' : 'Hide token'">
                        <i [class]="maskToken() ? 'fa-light fa-eye' : 'fa-light fa-eye-slash'" class="text-sm"></i>
                      </button>
                      <button
                        type="button"
                        (click)="copyToken()"
                        class="text-blue-600 hover:text-blue-800 transition-colors"
                        data-testid="copy-token-button"
                        aria-label="Copy token to clipboard">
                        <i class="fa-light fa-copy text-sm"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- Token Usage Guidelines -->
            <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
              <div class="flex">
                <div class="flex-shrink-0">
                  <i class="fa-light fa-exclamation-triangle text-amber-600"></i>
                </div>
                <div class="ml-3">
                  <h4 class="text-sm font-medium text-amber-800">Security Guidelines</h4>
                  <div class="mt-2 text-sm text-amber-700">
                    <ul class="list-disc list-inside space-y-1">
                      <li>This token is short-lived and automatically regenerated by the system</li>
                      <li>Never commit this token to version control</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        }
      </div>
    </lfx-card>
  </div>
</div>
