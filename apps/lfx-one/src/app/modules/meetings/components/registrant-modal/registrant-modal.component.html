<!-- Copyright The Linux Foundation and each contributor to LFX. -->
<!-- SPDX-License-Identifier: MIT -->

<form [formGroup]="form" (ngSubmit)="onSubmit()" class="flex flex-col gap-3" data-testid="registrant-modal-form">
  <!-- Use the existing registrant form component -->
  <lfx-registrant-form [form]="form" [registrant]="registrant" data-testid="registrant-modal-form-component"> </lfx-registrant-form>

  <!-- Informational Message for Committee Members -->
  @if (isCommitteeMember) {
    <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-700" data-testid="registrant-modal-committee-info">
      <i class="fa-light fa-info-circle mr-2"></i>
      This is a {{ committeeLabel.singular }} member. To update their details or remove them, please edit the individual {{ committeeLabel.plural }}.
    </div>
  }

  <!-- Action Buttons -->
  <div class="flex border-t border-gray-200 pt-4 justify-between items-center" data-testid="registrant-modal-actions">
    @if (isEditMode) {
      <div class="flex gap-2 items-center">
        <lfx-button
          label="Delete Registrant"
          severity="danger"
          size="small"
          type="button"
          [disabled]="isCommitteeMember"
          [tooltip]="isCommitteeMember ? committeeLabel.singular + ' members must be removed via the ' + committeeLabel.singular : ''"
          tooltipPosition="top"
          (onClick)="onDeleteRegistrant()"
          data-testid="registrant-modal-delete-button">
        </lfx-button>
        <lfx-button
          label="Resend Invitation"
          icon="fa-light fa-paper-plane"
          severity="secondary"
          size="small"
          type="button"
          [loading]="resendingInvitation()"
          [disabled]="resendingInvitation()"
          (onClick)="onResendInvitation()"
          data-testid="registrant-modal-resend-button">
        </lfx-button>
      </div>
    } @else {
      <!-- Add More Registrants Option (only in add mode) -->
      <lfx-checkbox
        inputId="add-more"
        [binary]="true"
        [form]="form"
        control="add_more_registrants"
        label="Add more registrants after saving"
        data-testid="registrant-modal-add-more-checkbox">
      </lfx-checkbox>
    }
    <div class="flex gap-2 items-center justify-end" data-testid="registrant-modal-form-actions">
      <lfx-button
        label="Cancel"
        severity="secondary"
        [text]="true"
        size="small"
        type="button"
        (onClick)="onCancel()"
        data-testid="registrant-modal-cancel-button">
      </lfx-button>
      <lfx-button
        [label]="isEditMode ? 'Update Registrant' : 'Add Registrant'"
        [loading]="submitting()"
        [disabled]="form.invalid || submitting() || isCommitteeMember"
        [tooltip]="isCommitteeMember ? committeeLabel.singular + ' member details must be updated via the ' + committeeLabel.singular : ''"
        tooltipPosition="top"
        type="submit"
        size="small"
        data-testid="registrant-modal-submit-button">
      </lfx-button>
    </div>
  </div>
</form>
