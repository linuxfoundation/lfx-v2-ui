<!-- Copyright The Linux Foundation and each contributor to LFX. -->
<!-- SPDX-License-Identifier: MIT -->

<div class="container mx-auto py-6 px-8">
  <!-- Loading State -->
  @if (loading()) {
    <div class="flex justify-center items-center min-h-96">
      <div class="text-center">
        <i class="fa-light fa-spinner-third fa-spin text-3xl text-blue-600 mb-4"></i>
        <p class="text-gray-600">Loading group details...</p>
      </div>
    </div>
  }

  <!-- Error State -->
  @if (error()) {
    <div class="flex justify-center items-center min-h-96">
      <div class="text-center">
        <i class="fa-light fa-exclamation-triangle text-3xl text-red-500 mb-4"></i>
        <h2 class="mb-2">Group Not Found</h2>
        <p class="text-gray-600 mb-4">The group you're looking for doesn't exist or has been removed.</p>
        <lfx-button label="Back to Groups" styleClass="p-button-outlined" (onClick)="goBack()"> </lfx-button>
      </div>
    </div>
  }

  <!-- Committee Content -->
  @if (committee()?.uid && !loading() && !error()) {
    <div class="flex flex-col gap-6">
      <!-- Header Section -->
      <div class="flex justify-between items-start">
        <div class="flex flex-col gap-4" data-testid="committee-view-header">
          <lfx-breadcrumb [model]="breadcrumbItems()" data-testid="committee-view-breadcrumb"></lfx-breadcrumb>
          <div class="flex flex-col gap-1">
            <h1 data-testid="committee-view-name">{{ committee()?.name }}</h1>
            <p class="text-gray-500" data-testid="committee-view-description">{{ committee()?.description }}</p>
          </div>
          <div class="flex items-center gap-4 text-sm text-gray-500">
            @if (committee()?.category) {
              <lfx-tag [value]="committee()!.category" [severity]="categorySeverity()"></lfx-tag>
            }
            <span class="text-gray-600">Created {{ formattedCreatedDate() }}</span>
            @if (committee()?.updated_at) {
              <span class="text-gray-600">Last updated {{ formattedUpdatedDate() }}</span>
            }
          </div>
        </div>

        <!-- Action Menu -->
        @if (!isBoardMember()) {
          <div class="flex items-center gap-3">
            <lfx-button icon="fa-light fa-file-lines" label="Edit Group" size="small" [routerLink]="['/groups', committee()?.uid || '', 'edit']"> </lfx-button>
          </div>
        }
      </div>

      <!-- Configurations Section -->
      <lfx-card data-testid="committee-view-configurations">
        <h3 class="text-sm font-medium mb-4" data-testid="committee-view-configurations-title">Configurations</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-3">
          <div class="flex items-center justify-between" data-testid="committee-view-config-public">
            <span class="text-sm">Public</span>
            <lfx-tag [value]="committee()?.public ? 'Enabled' : 'Disabled'" [severity]="committee()?.public ? 'success' : 'danger'"></lfx-tag>
          </div>
          <div class="flex items-center justify-between" data-testid="committee-view-config-voting">
            <span class="text-sm">Voting</span>
            <lfx-tag [value]="committee()?.enable_voting ? 'Enabled' : 'Disabled'" [severity]="committee()?.enable_voting ? 'success' : 'danger'"></lfx-tag>
          </div>
          <div class="flex items-center justify-between" data-testid="committee-view-config-business-email">
            <span class="text-sm">Business Email Required</span>
            <lfx-tag
              [value]="committee()?.business_email_required ? 'Enabled' : 'Disabled'"
              [severity]="committee()?.business_email_required ? 'success' : 'danger'"></lfx-tag>
          </div>
          <div class="flex items-center justify-between" data-testid="committee-view-config-sso-group">
            <span class="text-sm">SSO Group</span>
            <lfx-tag
              [value]="committee()?.sso_group_enabled ? 'Enabled' : 'Disabled'"
              [severity]="committee()?.sso_group_enabled ? 'success' : 'danger'"></lfx-tag>
          </div>
          <div class="flex items-center justify-between" data-testid="committee-view-config-audit">
            <span class="text-sm">Audit</span>
            <lfx-tag
              [value]="committee()?.is_audit_enabled ? 'Enabled' : 'Disabled'"
              [severity]="committee()?.is_audit_enabled ? 'success' : 'danger'"></lfx-tag>
          </div>
        </div>
      </lfx-card>

      <!-- Members Section -->
      @if (committee()?.uid) {
        <lfx-committee-members
          [committee]="committee()"
          [members]="members()"
          [membersLoading]="membersLoading()"
          (refresh)="refreshMembers()"></lfx-committee-members>
      }
    </div>
  }

  <!-- Confirmation Dialog -->
  <p-confirmDialog></p-confirmDialog>
</div>
