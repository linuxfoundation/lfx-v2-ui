<!-- Copyright The Linux Foundation and each contributor to LFX. -->
<!-- SPDX-License-Identifier: MIT -->

<form [formGroup]="form()" (ngSubmit)="onSubmit()">
  <!-- Two Column Layout -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    <!-- Left Column - Basic Information -->
    <div class="space-y-6">
      <h2 class="text-lg mb-4 font-inter font-normal">Basic Information</h2>

      <!-- Committee Name -->
      <div class="flex flex-col gap-2">
        <label for="committeeName" class="text-neutral-950 block text-sm font-medium"> {{ committeeLabel }} Name <span class="text-red-500">*</span> </label>
        <lfx-input-text
          size="small"
          [form]="form()"
          control="name"
          id="committeeName"
          [placeholder]="'Enter ' + committeeLabel.toLowerCase() + ' name'"
          styleClass="w-full border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0094FF] focus:border-transparent"></lfx-input-text>
        @if (form().get('name')?.errors?.['required'] && form().get('name')?.touched) {
          <p class="text-sm text-red-600">{{ committeeLabel }} name is required</p>
        }
      </div>

      <!-- Category -->
      <div class="flex flex-col gap-2">
        <label for="category" class="text-neutral-950 block text-sm font-medium"> Category <span class="text-red-500">*</span> </label>
        <lfx-select
          size="small"
          [form]="form()"
          control="category"
          [options]="categoryOptions"
          placeholder="Select a category"
          styleClass="w-full"
          id="category"></lfx-select>
        @if (form().get('category')?.errors?.['required'] && form().get('category')?.touched) {
          <p class="text-sm text-red-600">Category is required</p>
        }
      </div>

      <!-- Parent Committee -->
      <div class="flex flex-col gap-2">
        <label for="parentCommittee" class="text-neutral-950 block text-sm font-medium">Parent {{ committeeLabel }} (Optional)</label>
        <lfx-select
          size="small"
          [form]="form()"
          control="parent_uid"
          [options]="parentCommitteeOptions()"
          [placeholder]="'No Parent ' + committeeLabel"
          styleClass="w-full"
          id="parentCommittee"
          [showClear]="true"></lfx-select>
        <p class="text-xs text-slate-500">
          Select a parent {{ committeeLabel.toLowerCase() }} to create a sub-{{ committeeLabel.toLowerCase() }}. Leave empty for top-level
          {{ committeeLabel.toLowerCase() }}.
        </p>
      </div>

      <!-- Description -->
      <div class="flex flex-col gap-2">
        <label for="description" class="text-neutral-950 block text-sm font-medium">Description</label>
        <lfx-textarea
          [form]="form()"
          control="description"
          id="description"
          [placeholder]="'Enter ' + committeeLabel.toLowerCase() + ' description'"
          [rows]="3"
          styleClass="w-full border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0094FF] focus:border-transparent resize-none"></lfx-textarea>
      </div>

      <!-- Committee Website -->
      <div class="flex flex-col gap-2">
        <label for="website" class="text-neutral-950 block text-sm font-medium">{{ committeeLabel }} Website</label>
        <lfx-input-text
          size="small"
          [form]="form()"
          control="website"
          id="website"
          type="url"
          placeholder="https://example.com"
          styleClass="w-full border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0094FF] focus:border-transparent"></lfx-input-text>
        @if (form().get('website')?.errors?.['pattern'] && form().get('website')?.touched) {
          <p class="text-sm text-red-600">Please enter a valid URL</p>
        }
      </div>
    </div>

    <!-- Right Column - Settings -->
    <div class="space-y-6">
      <h2 class="text-lg mb-4 font-inter font-normal">Settings</h2>

      <div class="space-y-4">
        <!-- Business Email Required -->
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-2">
            <label for="businessEmail" class="text-neutral-950 text-sm font-medium">Business Email Required</label>
            <i
              class="fa-light fa-info-circle text-slate-400 cursor-help"
              pTooltip="Require members to have a business email address"
              tooltipPosition="right"></i>
          </div>
          <lfx-toggle size="small" [form]="form()" control="business_email_required" id="businessEmail"></lfx-toggle>
        </div>

        <!-- Enable Voting -->
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-2">
            <label for="enableVoting" class="text-neutral-950 text-sm font-medium">Enable Voting</label>
            <i class="fa-light fa-info-circle text-slate-400 cursor-help" pTooltip="Allow members to vote on committee matters" tooltipPosition="right"></i>
          </div>
          <lfx-toggle size="small" [form]="form()" control="enable_voting" id="enableVoting"></lfx-toggle>
        </div>

        <!-- Enable Audit -->
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-2">
            <label for="enableAudit" class="text-neutral-950 text-sm font-medium">Enable Audit</label>
          </div>
          <lfx-toggle size="small" [form]="form()" control="is_audit_enabled" id="enableAudit"></lfx-toggle>
        </div>

        <!-- Joinable -->
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-2">
            <label for="joinable" class="text-neutral-950 text-sm font-medium">Joinable</label>
            <i
              class="fa-light fa-info-circle text-slate-400 cursor-help"
              pTooltip="Allow users to join the committee without invitation"
              tooltipPosition="right"></i>
          </div>
          <lfx-toggle size="small" [form]="form()" control="joinable" id="joinable"></lfx-toggle>
        </div>

        <!-- Make Committee Public -->
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-2">
            <label for="makePublic" class="text-neutral-950 text-sm font-medium">Make {{ committeeLabel }} Public</label>
            <i class="fa-light fa-info-circle text-slate-400 cursor-help" pTooltip="Make committee visible to all users" tooltipPosition="right"></i>
          </div>
          <lfx-toggle size="small" [form]="form()" control="public" id="makePublic"></lfx-toggle>
        </div>

        <!-- Display Name (Conditional) -->
        @if (form().get('public')?.value === true) {
          <div class="flex flex-col gap-2">
            <label for="displayName" class="text-neutral-950 block text-sm font-medium">Public Display Name</label>
            <lfx-input-text
              size="small"
              [form]="form()"
              control="display_name"
              id="displayName"
              placeholder="Enter public display name"
              styleClass="w-full border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0094FF] focus:border-transparent"></lfx-input-text>
          </div>
        }

        <!-- Enable SSO Group -->
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-2">
            <label for="enableSSO" class="text-neutral-950 text-sm font-medium">Enable SSO Group</label>
          </div>
          <lfx-toggle size="small" [form]="form()" control="sso_group_enabled" id="enableSSO"></lfx-toggle>
        </div>

        <!-- SSO Group Name (Conditional) -->
        @if (form().get('sso_group_enabled')?.value === true) {
          <div class="flex flex-col gap-2">
            <label for="ssoGroupName" class="text-neutral-950 block text-sm font-medium">SSO Group Name</label>
            <lfx-input-text
              size="small"
              [form]="form()"
              control="sso_group_name"
              id="ssoGroupName"
              placeholder="Enter SSO group name"
              styleClass="w-full border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0094FF] focus:border-transparent"></lfx-input-text>
          </div>
        }
      </div>
    </div>
  </div>

  <!-- Navigation Controls - At the bottom of the card -->
  <div class="flex items-center justify-end mt-8 pt-8">
    <div class="flex gap-3">
      <lfx-button size="small" type="button" (click)="onCancel()" severity="secondary"> Cancel </lfx-button>
      <lfx-button type="submit" [disabled]="!form().valid || submitting()" size="small">
        @if (submitting()) {
          <i class="fa-light fa-spinner fa-spin"></i>
        }
        {{ isEditMode() ? 'Save Changes' : 'Create ' + committeeLabel }}
      </lfx-button>
    </div>
  </div>
</form>
