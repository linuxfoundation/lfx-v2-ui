<!-- Copyright The Linux Foundation and each contributor to LFX. -->
<!-- SPDX-License-Identifier: MIT -->

<lfx-card styleClass="border-0 shadow-md">
  <lfx-table
    [value]="committees()"
    [paginator]="committees().length > 10"
    [rows]="10"
    [rowsPerPageOptions]="[10, 25, 50]"
    styleClass="p-datatable-sm p-datatable-striped"
    sortField="name"
    [sortOrder]="1"
    data-testid="committee-dashboard-table">
    <ng-template #header>
      <tr>
        <th class="min-w-[250px]">
          <span class="text-xs font-sans text-gray-500">{{ committeeLabel() }}</span>
        </th>
        <th class="min-w-[300px]">
          <span class="text-xs font-sans text-gray-500">Description</span>
        </th>
        <th class="w-[80px]">
          <span class="text-xs font-sans text-gray-500">Members</span>
        </th>
        <th class="w-[80px]">
          <span class="text-xs font-sans text-gray-500">Voting</span>
        </th>
        <th class="w-[100px]">
          <span class="text-xs font-sans text-gray-500">Last Updated</span>
        </th>
        <th class="w-[120px]">
          <span class="text-xs font-sans text-gray-500">Actions</span>
        </th>
      </tr>
    </ng-template>
    <ng-template #body let-committee>
      <tr [attr.data-testid]="'committee-row-' + committee.uid">
        <td>
          <div class="flex flex-col gap-1">
            <lfx-tag [value]="committee.category || 'Other'" [severity]="getCategorySeverity(committee.category || 'Other')"></lfx-tag>
            <div class="flex items-center gap-2">
              <a
                [routerLink]="['/groups', committee.uid]"
                class="font-inter font-medium leading-[16px] not-italic text-gray-900 text-[12px] text-nowrap whitespace-pre">
                {{ committee.name }}
              </a>
              @if (!committee.public) {
                <i class="fa-light fa-lock text-slate-500" pTooltip="Private" tooltipPosition="top"></i>
              }
            </div>
          </div>
        </td>
        <td>
          <span class="text-xs text-gray-600">{{ committee.description || '-' }}</span>
        </td>
        <td>
          <a [routerLink]="['/groups', committee.uid]" class="text-xs text-blue-500 hover:text-blue-600 hover:underline cursor-pointer">
            {{ committee.total_members || 0 }}
          </a>
        </td>
        <td>
          @if (committee.enable_voting) {
            <i class="fa-light fa-check w-4 h-4 text-green-600"></i>
          }
        </td>
        <td>
          <span class="text-xs text-gray-900 whitespace-nowrap">{{ committee.updated_at | date: 'MMM d, y' }}</span>
        </td>
        <td>
          @if (canManageCommittee()) {
            <div class="flex items-center gap-1">
              <lfx-button
                icon="fa-light fa-user-plus"
                severity="secondary"
                size="small"
                [text]="true"
                styleClass="h-8 w-8 text-slate-500 hover:text-slate-700 hover:bg-slate-100"
                (onClick)="onAddMember(committee)"
                [attr.data-testid]="'committee-add-member-' + committee.uid"
                [pTooltip]="'Add Member'"
                tooltipPosition="top">
              </lfx-button>
              <a [routerLink]="['/groups', committee.uid, 'edit']">
                <lfx-button
                  icon="fa-light fa-pencil"
                  severity="secondary"
                  size="small"
                  [outlined]="false"
                  [text]="true"
                  styleClass="h-8 w-8 text-slate-500 hover:text-slate-700 hover:bg-slate-100"
                  [attr.data-testid]="'committee-edit-' + committee.uid"
                  [pTooltip]="'Edit ' + committeeLabel()"
                  tooltipPosition="top">
                </lfx-button>
              </a>
              <lfx-button
                icon="fa-light fa-trash-can"
                severity="secondary"
                size="small"
                [text]="true"
                styleClass="h-8 w-8 text-slate-500 hover:text-slate-700 hover:bg-slate-100"
                (onClick)="onDeleteCommittee(committee)"
                [disabled]="isDeleting()"
                [attr.data-testid]="'committee-delete-' + committee.uid"
                [pTooltip]="'Delete ' + committeeLabel()"
                tooltipPosition="top">
              </lfx-button>
            </div>
          }
        </td>
      </tr>
    </ng-template>
    <ng-template #emptymessage>
      <tr>
        <td colspan="6" class="text-center py-8">
          <i class="fa-light fa-folder-open text-3xl text-gray-400 mb-2"></i>
          <p class="text-sm text-gray-500">No {{ committeeLabel().toLowerCase() }}s found</p>
        </td>
      </tr>
    </ng-template>
  </lfx-table>
</lfx-card>

<!-- Confirmation Dialog -->
<p-confirmDialog></p-confirmDialog>
