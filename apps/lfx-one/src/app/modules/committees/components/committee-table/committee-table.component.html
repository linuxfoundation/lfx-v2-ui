<!-- Copyright The Linux Foundation and each contributor to LFX. -->
<!-- SPDX-License-Identifier: MIT -->

<lfx-card styleClass="border-0 shadow-md">
  <div class="overflow-x-auto">
    <table class="min-w-full" data-testid="committee-dashboard-table">
      <thead>
        <tr>
          <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 min-w-[250px]">{{ committeeLabel() }}</th>
          <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 min-w-[300px]">Description</th>
          <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 w-[80px]">Members</th>
          <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 w-[80px]">Voting</th>
          <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 w-[100px]">Last Updated</th>
          <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 w-[120px]"></th>
        </tr>
      </thead>
      <tbody>
        @for (committee of committees(); track committee.uid) {
          <tr class="hover:bg-slate-50" [attr.data-testid]="'committee-row-' + committee.uid">
            <td class="px-3 py-3 w-[180px]">
              <div class="flex flex-col gap-1">
                <lfx-tag [value]="committee.category || 'Other'" [severity]="getCategorySeverity(committee.category || 'Other')"></lfx-tag>
                <div class="flex items-center gap-2">
                  <p class="font-inter font-medium leading-[16px] not-italic text-gray-900 text-[12px] text-nowrap whitespace-pre">
                    {{ committee.name }}
                  </p>
                  @if (!committee.public) {
                    <i class="fa-light fa-lock text-slate-500" pTooltip="Private" tooltipPosition="top"></i>
                  }
                </div>
              </div>
            </td>
            <td class="px-3 py-3 text-xs min-w-[300px]">{{ committee.description || '-' }}</td>
            <td class="px-3 py-3 w-[140px]">
              <a [routerLink]="['/groups', committee.uid]" class="text-xs text-blue-500 hover:text-blue-600 hover:underline cursor-pointer">
                {{ committee.total_members || 0 }}
              </a>
            </td>
            <td class="px-3 py-3 text-xs text-gray-900 w-[80px]">
              @if (committee.enable_voting) {
                <i class="fa-light fa-check w-4 h-4 text-green-600"></i>
              }
            </td>
            <td class="px-3 py-3 text-xs text-gray-900 w-[100px] whitespace-nowrap">{{ committee.updated_at | date: 'MMM d, y' }}</td>
            <td class="px-3 py-3 text-xs w-[120px]">
              @if (canManageCommittee()) {
                <div class="flex items-center gap-1">
                  <lfx-button
                    icon="fa-light fa-user-plus"
                    severity="secondary"
                    size="small"
                    [text]="true"
                    styleClass="h-8 w-8 text-slate-500 hover:text-slate-700 hover:bg-slate-100"
                    (onClick)="onAddMember(committee)"
                    [attr.data-testid]="'committee-add-member-' + committee.uid"
                    [pTooltip]="'Add Member'"
                    tooltipPosition="top">
                  </lfx-button>
                  <a [routerLink]="['/groups', committee.uid, 'edit']">
                    <lfx-button
                      icon="fa-light fa-pencil"
                      severity="secondary"
                      size="small"
                      [outlined]="false"
                      [text]="true"
                      styleClass="h-8 w-8 text-slate-500 hover:text-slate-700 hover:bg-slate-100"
                      [attr.data-testid]="'committee-edit-' + committee.uid"
                      [pTooltip]="'Edit ' + committeeLabel()"
                      tooltipPosition="top">
                    </lfx-button>
                  </a>
                  <lfx-button
                    icon="fa-light fa-trash-can"
                    severity="secondary"
                    size="small"
                    [text]="true"
                    styleClass="h-8 w-8 text-slate-500 hover:text-slate-700 hover:bg-slate-100"
                    (onClick)="onDeleteCommittee(committee)"
                    [disabled]="isDeleting()"
                    [attr.data-testid]="'committee-delete-' + committee.uid"
                    [pTooltip]="'Delete ' + committeeLabel()"
                    tooltipPosition="top">
                  </lfx-button>
                </div>
              }
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</lfx-card>

<!-- Confirmation Dialog -->
<p-confirmDialog></p-confirmDialog>
