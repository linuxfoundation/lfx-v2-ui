<!-- Copyright The Linux Foundation and each contributor to LFX. -->
<!-- SPDX-License-Identifier: MIT -->

<div class="flex flex-col items-center gap-1" data-testid="nps-gauge">
  <!-- Chart Container with Needle Overlay -->
  <div class="relative" [style.width]="sizeConfig().width" [style.height]="sizeConfig().height">
    <!-- Doughnut Chart as Gauge -->
    <p-chart type="doughnut" [data]="chartData()" [options]="chartOptions()" [style]="{ width: '100%', height: '100%' }"></p-chart>

    <!-- Needle SVG Overlay -->
    <svg class="absolute inset-0 w-full h-full pointer-events-none" [attr.viewBox]="'0 0 ' + sizeConfig().widthNum + ' ' + sizeConfig().heightNum">
      <!-- Needle -->
      <g [attr.transform]="'translate(' + sizeConfig().widthNum / 2 + ', ' + sizeConfig().centerY + ') rotate(' + needleRotation() + ')'">
        <!-- Needle body -->
        <polygon
          [attr.points]="'0,-' + sizeConfig().needleLength + ' -' + sizeConfig().needleWidth + ',0 0,8 ' + sizeConfig().needleWidth + ',0'"
          fill="#1e293b"
          class="drop-shadow-sm" />
        <!-- Center circle -->
        <circle r="6" fill="#1e293b" />
        <circle r="3" fill="#ffffff" />
      </g>
    </svg>
  </div>

  <!-- Score Value and Label -->
  <div class="flex flex-col items-center">
    <span class="font-bold" [class]="sizeConfig().fontSize" [style.color]="scoreColor()" data-testid="nps-gauge-score">
      {{ formattedScore() }}
    </span>
    <span class="font-medium" [class]="sizeConfig().labelSize" [style.color]="scoreColor()" data-testid="nps-gauge-label">
      {{ scoreLabel() }}
    </span>
  </div>
</div>
