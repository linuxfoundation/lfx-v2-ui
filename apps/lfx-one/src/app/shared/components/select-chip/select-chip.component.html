<!-- Copyright The Linux Foundation and each contributor to LFX. -->
<!-- SPDX-License-Identifier: MIT -->

<button
  type="button"
  class="select-chip-trigger inline-flex items-center gap-2 cursor-pointer"
  [class]="styleClass()"
  [class.opacity-50]="disabled()"
  [class.cursor-not-allowed]="disabled()"
  [disabled]="disabled()"
  [attr.aria-label]="ariaLabel() || selectedLabel()"
  [attr.aria-expanded]="isOpen()"
  [attr.data-testid]="testIdPrefix() + '-trigger'"
  (click)="onTriggerClick($event)">
  <span class="select-chip-label font-medium rounded-md" [class]="chipColorClasses() + ' ' + chipSizeClasses()">
    {{ selectedLabel() }}
  </span>
  @if (showChevron()) {
    <i
      class="fa-light fa-chevron-down text-gray-400 transition-transform duration-200"
      [class.rotate-180]="isOpen()"
      [class.text-[10px]]="size() === 'small'"
      [class.text-xs]="size() === 'medium'"></i>
  }
</button>

<p-popover #selectChipPopover [styleClass]="'select-chip-popover ' + panelStyleClass()" appendTo="body" (onShow)="onPopoverShow()" (onHide)="onPopoverHide()">
  <div class="select-chip-menu" [attr.data-testid]="testIdPrefix() + '-menu'">
    @for (option of options(); track option.value) {
      <button
        type="button"
        class="select-chip-option"
        [class.disabled]="option.disabled"
        [disabled]="option.disabled"
        [attr.data-testid]="testIdPrefix() + '-option-' + option.value"
        (click)="onOptionSelect(option)">
        {{ option.label }}
      </button>
    }

    @if (options().length === 0) {
      <div class="select-chip-empty">No options available</div>
    }
  </div>
</p-popover>
