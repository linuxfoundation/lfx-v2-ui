<!-- Copyright The Linux Foundation and each contributor to LFX. -->
<!-- SPDX-License-Identifier: MIT -->

<div class="organization-search-container">
  @if (!manualMode()) {
    <lfx-autocomplete
      [form]="organizationForm"
      control="organizationSearch"
      [placeholder]="placeholder()"
      [suggestions]="suggestions()"
      [styleClass]="styleClass()"
      [inputStyleClass]="inputStyleClass()"
      [panelStyleClass]="panelStyleClass()"
      [dataTestId]="dataTestId()"
      optionLabel="name"
      optionValue="name"
      appendTo="body"
      (completeMethod)="onSearchComplete($event)"
      (onSelect)="onOrganizationSelected($event)"
      (onClear)="onSearchClear()">
      <!-- Empty template -->
      <ng-template #empty>
        <div class="p-3 text-center">
          <p class="text-sm text-gray-600 mb-2">No organizations found</p>
          <button type="button" class="text-sm text-primary hover:underline" (click)="switchToManualMode()">Enter details manually</button>
        </div>
      </ng-template>
    </lfx-autocomplete>
  } @else {
    <!-- Manual entry mode -->
    <div class="flex flex-col gap-3">
      @if (nameControl()) {
        <lfx-input-text [form]="form()" [control]="nameControl()!" placeholder="Enter organization name" styleClass="w-full" size="small" />
      }

      @if (domainControl()) {
        <lfx-input-text
          [form]="form()"
          [control]="domainControl()!"
          placeholder="Enter website (e.g., example.com or https://example.com)"
          styleClass="w-full"
          size="small" />
      }

      <button type="button" class="text-xs text-primary hover:underline" (click)="switchToSearchMode()">‚Üê Back to search</button>
    </div>
  }
</div>
