<!-- Copyright The Linux Foundation and each contributor to LFX. -->
<!-- SPDX-License-Identifier: MIT -->

<!-- Dev Toolbar (fixed at top) -->
<lfx-dev-toolbar></lfx-dev-toolbar>

<div class="flex min-h-screen" [ngClass]="{ 'pt-12': showDevToolbar() }">
  <!-- Sidebar - Desktop -->
  <div class="hidden lg:block w-64 flex-shrink-0 fixed left-0 bottom-0" [ngClass]="{ 'top-12': showDevToolbar(), 'top-0': !showDevToolbar() }">
    <lfx-sidebar [items]="sidebarItems()" [footerItems]="sidebarFooterItems()" [showProjectSelector]="true"></lfx-sidebar>
  </div>

  <!-- Sidebar - Mobile Drawer -->
  <p-drawer
    [visible]="showMobileSidebar()"
    (visibleChange)="onDrawerVisibilityChange($event)"
    position="left"
    [modal]="true"
    [dismissable]="true"
    [showCloseIcon]="true"
    styleClass="lg:hidden w-86 mobile-sidebar-drawer"
    data-testid="mobile-sidebar-drawer">
    <ng-template #header>
      <div class="flex items-center gap-3">
        <a [routerLink]="['/']" class="flex items-center">
          <img src="/images/lfx-one-logo.svg" alt="LFX Logo" class="w-auto h-5" />
        </a>
      </div>
    </ng-template>
    <lfx-sidebar [items]="sidebarItems()" [footerItems]="sidebarFooterItems()" [showProjectSelector]="true" [mobile]="true"></lfx-sidebar>
  </p-drawer>

  <!-- Main Content Area -->
  <main class="flex-1 min-w-0 transition-all duration-300 lg:ml-64 flex flex-col" data-testid="main-content">
    <!-- Mobile Menu Button -->
    <div class="lg:hidden sticky z-30 bg-white border-b border-gray-200 px-5 py-3" [ngClass]="{ 'top-12': showDevToolbar(), 'top-0': !showDevToolbar() }">
      <button
        type="button"
        class="flex items-center justify-center w-10 h-10 rounded-lg hover:bg-gray-100 transition-colors"
        (click)="toggleMobileSidebar()"
        aria-label="Toggle menu"
        data-testid="mobile-menu-button">
        <i class="fa-light fa-bars text-gray-600 text-xl"></i>
      </button>
    </div>
    <div class="flex-grow px-5 md:px-8 py-6">
      <router-outlet />
    </div>
    <!-- Footer Component -->
    <lfx-footer class="md:ml-8 p-8 mt-auto"></lfx-footer>
  </main>
</div>
